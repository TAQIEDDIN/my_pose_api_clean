<!-- ÙÙŠ ØµÙØ­Ø© admin dashboard -->
<!-- Ù…Ø«Ø§Ù„: patients_list.html -->

<div class="patient-card">
    <h3>{{ patient.name }}</h3>
    <p>ID: {{ patient.user_id }}</p>
    
    <button onclick="startVideoCall('{{ patient.user_id }}')" class="btn-video-call">
        ğŸ“¹ Ø¨Ø¯Ø¡ Ù…ÙƒØ§Ù„Ù…Ø© ÙÙŠØ¯ÙŠÙˆ
    </button>
</div>

<script>
const socket = io("http://10.30.x.x:5000", { 
    transports: ["websocket"] 
});

socket.on("connect", () => {
    console.log("âœ… Admin connected to socket");
});

socket.on("call_initiated", (data) => {
    console.log("ğŸ“ Call initiated:", data);
    
    // Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ù„ØµÙØ­Ø© Ø§Ù„Ù…ÙƒØ§Ù„Ù…Ø©
    window.location.href = `/admin/video_call/${data.call_id}`;
});

socket.on("call_rejected", (data) => {
    alert("âŒ Ø§Ù„Ù…Ø±ÙŠØ¶ Ø±ÙØ¶ Ø§Ù„Ù…ÙƒØ§Ù„Ù…Ø©");
});

socket.on("call_accepted", (data) => {
    console.log("âœ… Patient accepted call:", data);
});

function startVideoCall(userId) {
    console.log("ğŸ“ Starting call with user:", userId);
    
    socket.emit("start_call", {
        user_id: userId
    });
    
    // Ø¹Ø±Ø¶ loading
    showLoading("Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ù…Ø±ÙŠØ¶...");
}

function showLoading(message) {
    // ÙŠÙ…ÙƒÙ†Ùƒ Ø¥Ø¶Ø§ÙØ© modal Ø£Ùˆ spinner
    console.log(message);
}
</script>

<style>
.btn-video-call {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    color: white;
    border: none;
    padding: 12px 24px;
    border-radius: 25px;
    cursor: pointer;
    font-size: 16px;
    font-weight: 600;
    transition: all 0.3s ease;
    box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
}

.btn-video-call:hover {
    transform: translateY(-2px);
    box-shadow: 0 8px 20px rgba(102, 126, 234, 0.6);
}

.btn-video-call:active {
    transform: translateY(0);
}
</style>